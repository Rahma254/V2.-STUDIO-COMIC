<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nabila Ahmad - Grand Creative Studio V2</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-deep-space: #111317; --surface-primary: #1a1d23; --surface-secondary: #252932;
            --border-color: #333842; --text-primary: #e0e0e0; --text-secondary: #a0a4b8;
            --accent-primary: #8A2BE2; --accent-secondary: #4A90E2; --accent-tertiary: #34D399;
            --font-ui: 'Poppins', sans-serif; --font-literary: 'Cormorant Garamond', serif;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { font-family: var(--font-ui); background-color: var(--bg-deep-space); color: var(--text-primary); line-height: 1.7; overflow-x: hidden; }

        .marquee-container {
            width: 100%; background: linear-gradient(90deg, var(--accent-primary), var(--accent-tertiary));
            color: white; padding: 0.5rem 0; overflow: hidden; white-space: nowrap; position: fixed; top: 0; left: 0; z-index: 1000;
        }
        .marquee-text { display: inline-block; padding-left: 100%; animation: marquee 30s linear infinite; font-weight: 600; }
        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

        .studio-container { max-width: 1600px; margin: 0 auto; padding: 2rem; padding-top: 5rem; }
        .studio-header { text-align: center; margin-bottom: 3rem; padding-bottom: 2rem; border-bottom: 1px solid var(--border-color); }
        .studio-header h1 { font-size: 3rem; font-weight: 700; background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary), var(--accent-tertiary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 0.5rem; }
        .studio-header p { color: var(--text-secondary); font-size: 1.2rem; }
        
        .card { background-color: var(--surface-primary); border-radius: 16px; padding: 2rem; border: 1px solid var(--border-color); transition: all 0.3s ease; }
        .card:hover { border-color: var(--accent-secondary); }

        .api-config-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem; }
        .api-card { background: var(--surface-secondary); padding: 1.5rem; border-radius: 12px; }
        .api-card h3 { margin-bottom: 0.5rem; }
        .api-card input { width: 100%; padding: 0.8rem; margin-top: 0.5rem; background-color: var(--surface-primary); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); }

        .studio-tabs { display: flex; flex-wrap: wrap; border-bottom: 1px solid var(--border-color); margin-bottom: 2rem; }
        .tab-button { padding: 1rem 1.5rem; cursor: pointer; border: none; background: none; color: var(--text-secondary); font-size: 1.1rem; font-weight: 600; position: relative; transition: color 0.3s ease; }
        .tab-button:hover { color: var(--text-primary); }
        .tab-button.active { color: var(--text-primary); }
        .tab-button.active::after { content: ''; position: absolute; bottom: -1px; left: 0; width: 100%; height: 3px; background: linear-gradient(90deg, var(--accent-secondary), var(--accent-tertiary)); border-radius: 3px; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .control-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; }
        .control-grid .card h3 { font-size: 1.3rem; margin-bottom: 1.5rem; }
        label { display: block; font-weight: 600; color: var(--text-secondary); margin-bottom: 0.5rem; }
        input[type="text"], input[type="file"], textarea, select { width: 100%; padding: 0.8rem 1rem; background-color: var(--surface-secondary); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-family: var(--font-ui); font-size: 1rem; margin-bottom: 1.5rem; }
        input[type="file"]::file-selector-button { background-color: var(--accent-secondary); color: white; border: none; padding: 0.8rem 1rem; border-radius: 8px; cursor: pointer; }
        textarea { resize: vertical; min-height: 120px; }
        .main-action-button { width: 100%; padding: 1.2rem; font-size: 1.2rem; font-weight: 700; color: white; background: linear-gradient(90deg, var(--accent-secondary), var(--accent-tertiary)); border: none; border-radius: 8px; cursor: pointer; margin-top: 1rem; transition: all 0.3s ease; display: flex; justify-content: center; align-items: center; gap: 1rem; }
        .main-action-button:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.2); }
        .main-action-button:disabled { opacity: 0.5; cursor: not-allowed; }

        .output-container { margin-top: 3rem; }
        .output-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
        .output-header h2 { font-size: 2rem; }
        .copy-button { padding: 0.6rem 1.2rem; background: var(--surface-secondary); color: var(--text-secondary); border: 1px solid var(--border-color); border-radius: 8px; cursor: pointer; transition: all 0.3s ease; }
        .copy-button:hover { background-color: var(--accent-tertiary); color: white; border-color: var(--accent-tertiary); }
        .output-box { background: var(--surface-primary); border-radius: 16px; padding: 2rem; border: 1px solid var(--border-color); min-height: 200px; font-family: var(--font-literary); font-size: 1.2rem; line-height: 1.8; white-space: pre-wrap; color: var(--text-primary); }
        .placeholder-text { color: var(--text-secondary); font-style: italic; font-family: var(--font-ui); font-size: 1.1rem; }
        .output-box img { max-width: 100%; border-radius: 8px; margin: auto; display: block; }
        .spinner { width: 24px; height: 24px; border: 3px solid rgba(255, 255, 255, 0.3); border-top-color: #fff; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="marquee-container">
        <p class="marquee-text">âœ¨ Selamat Datang di Grand Creative Studio V2 by Nabila Ahmad! Platform canggih untuk Novel, Komik, dan Podcast Anda. âœ¨</p>
    </div>

    <div class="studio-container">
        <header class="studio-header">
            <h1>Grand Creative Studio V2</h1>
            <p>Novel, Comic, and Podcast AI Powerhouse</p>
        </header>

        <section class="api-config-grid">
            <div class="api-card">
                <h3>OpenAI API</h3>
                <input type="password" id="openAIKey" placeholder="sk-...">
            </div>
             <div class="api-card">
                <h3>AssemblyAI API</h3>
                <input type="password" id="assemblyAIKey" placeholder="Untuk Transkripsi Podcast">
            </div>
             <div class="api-card">
                <h3>Cleanvoice API</h3>
                <input type="password" id="cleanvoiceAIKey" placeholder="Integrasi Segera Hadir...">
            </div>
        </section>

        <nav class="studio-tabs">
            <button class="tab-button active" data-tab="novelStudio">Novel Studio</button>
            <button class="tab-button" data-tab="comicStudio">Comic Studio</button>
            <button class="tab-button" data-tab="podcastStudio">Podcast Studio</button>
        </nav>

        <!-- NOVEL STUDIO -->
        <div id="novelStudio" class="tab-content active">
            <!-- UI Novel Studio sama seperti sebelumnya, tidak perlu diubah -->
             <div class="control-grid">
                <div class="card">
                    <h3>ðŸ“– Pengaturan Novel (Super SEO)</h3>
                    <label for="novelGenre">Pilih Genre</label>
                    <select id="novelGenre">
                        <option value="Contemporary Romance">Romansa Kontemporer</option><option value="Historical Romance">Romansa Sejarah</option><option value="Fantasy">Fantasi</option><option value="Urban Fantasy">Fantasi Urban</option><option value="Science Fiction">Fiksi Ilmiah</option><option value="Dystopian">Distopia</option><option value="Mystery">Misteri</option><option value="Thriller">Thriller</option><option value="Horror">Horor</option><option value="Adventure">Petualangan</option><option value="Young Adult (YA)">Remaja</option><option value="Wuxia / Xianxia">Wuxia / Xianxia</option>
                    </select>
                    <label for="novelPremis">Premis / Ide Dasar Cerita</label>
                    <textarea id="novelPremis" rows="6" placeholder="Contoh: Seorang hacker menemukan konspirasi global di dalam kode sumber sebuah game online populer."></textarea>
                </div>
                <div class="card">
                    <h3>ðŸš€ Generator Bab</h3>
                    <p style="color:var(--text-secondary); margin-bottom:2rem;">Tekan tombol untuk membuat bab yang dioptimalkan untuk engagement atau melanjutkan cerita.</p>
                    <button id="generateNovelBtn" class="main-action-button"><span class="btn-text">Buat Bab (4000+ Kata)</span><div class="spinner" style="display: none;"></div></button>
                </div>
            </div>
            <div class="output-container">
                <div class="output-header"><h2>Naskah Novel Anda</h2><button class="copy-button" onclick="copyToClipboard('novelOutput')">Salin Naskah</button></div>
                <div id="novelOutput" class="output-box" contenteditable="true"><p class="placeholder-text">Bab novel dengan struktur SEO-friendly akan muncul di sini...</p></div>
            </div>
        </div>

        <!-- COMIC STUDIO -->
        <div id="comicStudio" class="tab-content">
             <div class="control-grid">
                <div class="card">
                    <h3>ðŸ‘¤ Karakter & Aksi</h3>
                    <input type="text" id="comicChar" placeholder="Deskripsi Karakter Utama..."><textarea id="comicAction" rows="4" placeholder="Aksi / Adegan..."></textarea><input type="text" id="comicEmotion" placeholder="Ekspresi / Emosi...">
                </div>
                <div class="card">
                    <h3>ðŸŽ¨ Gaya & Komposisi</h3>
                    <select id="comicStyle"><option value="90s anime style, cel shading, vibrant colors">Anime 90an</option><option value="Modern manga style, black and white, sharp lines">Manga Modern (B&W)</option><option value="American comic book style, ink outlines, bold colors">Komik Amerika</option><option value="Cinematic, hyperrealistic, 8k">Hiper-realistis</option><option value="Pixar animation style, soft lighting">Gaya Animasi Pixar</option></select>
                    <input type="text" id="comicAngle" placeholder="Sudut Kamera..."><input type="text" id="comicLighting" placeholder="Pencahayaan...">
                </div>
            </div>
            <button id="generateComicBtn" class="main-action-button" style="margin-top: 2rem; max-width: 500px; margin-inline: auto;"><span class="btn-text">Buat Gambar Komik</span><div class="spinner" style="display: none;"></div></button>
            <div class="output-container">
                <div class="output-header"><h2>Hasil Gambar Komik</h2></div>
                <div id="comicImageOutput" class="output-box" style="display: flex; align-items: center; justify-content: center;"><p class="placeholder-text">Gambar komik Anda akan muncul di sini...</p></div>
            </div>
        </div>

        <!-- PODCAST STUDIO -->
        <div id="podcastStudio" class="tab-content">
            <div class="control-grid">
                <div class="card">
                    <h3>ðŸ“¤ Unggah & Analisis</h3>
                    <label for="audioFile">Pilih File Audio (MP3, WAV, dll.)</label>
                    <input type="file" id="audioFile" accept="audio/*">
                    <p style="color:var(--text-secondary); margin-top:2rem;">Gunakan AssemblyAI untuk transkripsi audio. Fitur premium seperti deteksi pembicara & topik akan segera hadir.</p>
                </div>
                <div class="card">
                    <h3>ðŸš€ Transkripsi</h3>
                     <p style="color:var(--text-secondary); margin-bottom:2rem;">Setelah memilih file, tekan tombol di bawah untuk memulai proses transkripsi. Proses ini bisa memakan waktu beberapa menit tergantung durasi audio.</p>
                    <button id="transcribeBtn" class="main-action-button"><span class="btn-text">Transkripsikan Audio</span><div class="spinner" style="display: none;"></div></button>
                </div>
            </div>
             <div class="output-container">
                <div class="output-header"><h2>Hasil Transkripsi</h2><button class="copy-button" onclick="copyToClipboard('podcastOutput')">Salin Teks</button></div>
                <div id="podcastOutput" class="output-box" style="font-family:var(--font-ui); font-size:1rem;"><p class="placeholder-text">Teks dari audio Anda akan muncul di sini...</p></div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // === ELEMEN DOM & Kunci API ===
            const openAIKeyInput = document.getElementById('openAIKey');
            const assemblyAIKeyInput = document.getElementById('assemblyAIKey');
            const tabs = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            // Novel
            const novelGenreSelect = document.getElementById('novelGenre');
            const novelPremisTextarea = document.getElementById('novelPremis');
            const generateNovelBtn = document.getElementById('generateNovelBtn');
            const novelOutputDiv = document.getElementById('novelOutput');

            // Komik
            const comicCharInput = document.getElementById('comicChar');
            const comicActionTextarea = document.getElementById('comicAction');
            const comicEmotionInput = document.getElementById('comicEmotion');
            const comicStyleSelect = document.getElementById('comicStyle');
            const comicAngleInput = document.getElementById('comicAngle');
            const comicLightingInput = document.getElementById('comicLighting');
            const generateComicBtn = document.getElementById('generateComicBtn');
            const comicImageOutputDiv = document.getElementById('comicImageOutput');

            // Podcast
            const audioFileInput = document.getElementById('audioFile');
            const transcribeBtn = document.getElementById('transcribeBtn');
            const podcastOutputDiv = document.getElementById('podcastOutput');

            // === LOGIKA UTAMA ===

            // Sistem Tab
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(item => item.classList.remove('active'));
                    tab.classList.add('active');
                    const target = document.getElementById(tab.dataset.tab);
                    tabContents.forEach(content => content.classList.remove('active'));
                    target.classList.add('active');
                });
            });

            // Handler Novel Studio (Super SEO)
            generateNovelBtn.addEventListener('click', async () => {
                const genre = novelGenreSelect.value;
                const premis = novelPremisTextarea.value.trim();
                const currentText = novelOutputDiv.textContent.trim();
                const isFirstChapter = currentText.startsWith('Bab novel dengan struktur');

                if (!premis) { alert('Harap isi premis cerita!'); return; }

                let messages = [];
                if (isFirstChapter) {
                    const systemPrompt = `Anda adalah novelis dan editor SEO profesional. Tugas Anda adalah menulis bab novel yang sangat engaging, dengan struktur yang disukai algoritma platform. Genre: ${genre}. Premis: "${premis}". ATURAN: 1. Gunakan paragraf pendek (2-4 kalimat) untuk keterbacaan maksimal. 2. Gunakan markdown bold (**teks**) untuk menekankan aksi penting atau dialog kunci. 3. Buat hook yang kuat di awal bab. 4. Akhiri bab dengan cliffhanger atau pertanyaan yang membuat penasaran. 5. Target panjang minimal 4000 kata. Anda HANYA merespon dengan teks cerita.`;
                    messages.push({ role: 'system', content: systemPrompt });
                    messages.push({ role: 'user', content: 'Tuliskan Bab 1.' });
                } else {
                    const systemPrompt = `Anda adalah novelis dan editor SEO profesional yang melanjutkan cerita. Ingat semua konteks. Lanjutkan dengan ATURAN yang sama: paragraf pendek, bold untuk penekanan, dan cliffhanger. Target panjang minimal 4000 kata.`;
                    messages.push({ role: 'system', content: systemPrompt });
                    messages.push({ role: 'assistant', content: `Naskah sejauh ini: ${currentText}` });
                    messages.push({ role: 'user', content: 'Lanjutkan dengan bab berikutnya.' });
                }
                
                const result = await callOpenAIChat(messages, 4095, generateNovelBtn);
                if (result) {
                    const formattedResult = result.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    if (isFirstChapter) {
                        novelOutputDiv.innerHTML = formattedResult;
                    } else {
                        novelOutputDiv.innerHTML += `<br><br><hr><br><br>${formattedResult}`;
                    }
                }
            });

            // Handler Comic Studio (Image Generator)
            generateComicBtn.addEventListener('click', async () => {
                const char = comicCharInput.value.trim();
                const action = comicActionTextarea.value.trim();
                const emotion = comicEmotionInput.value.trim();
                const style = comicStyleSelect.value;
                const angle = comicAngleInput.value.trim();
                const lighting = comicLightingInput.value.trim();
                if (!char || !action) { alert('Harap isi Karakter dan Aksi!'); return; }

                let finalPrompt = `A single comic book panel, ${style}. Featuring: ${char}, ${action}. ${emotion ? `Expression: ${emotion}.` : ''} ${angle ? `Shot: ${angle}.` : ''} ${lighting ? `Lighting: ${lighting}.` : ''} Extremely high quality, detailed, professional comic art.`;
                
                setLoading(generateComicBtn, true);
                comicImageOutputDiv.innerHTML = '<div class="spinner"></div>'; // Tampilkan spinner di box
                
                try {
                    const apiKey = openAIKeyInput.value.trim();
                    if (!apiKey) throw new Error('OpenAI API Key belum diisi!');
                    
                    const response = await fetch('https://api.openai.com/v1/images/generations', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${apiKey}`},
                        body: JSON.stringify({ model: "dall-e-3", prompt: finalPrompt, n: 1, size: "1024x1024" }),
                    });
                    if (!response.ok) {
                        const err = await response.json();
                        throw new Error(err.error.message);
                    }
                    const data = await response.json();
                    comicImageOutputDiv.innerHTML = `<img src="${data.data[0].url}" alt="Generated Comic Panel">`;
                } catch (error) {
                    alert(`Error: ${error.message}`);
                    comicImageOutputDiv.innerHTML = '<p class="placeholder-text">Gagal membuat gambar. Silakan coba lagi.</p>';
                } finally {
                    setLoading(generateComicBtn, false);
                }
            });
            
            // Handler Podcast Studio (AssemblyAI)
            transcribeBtn.addEventListener('click', async () => {
                const apiKey = assemblyAIKeyInput.value.trim();
                const file = audioFileInput.files[0];
                if (!apiKey) { alert('AssemblyAI API Key belum diisi!'); return; }
                if (!file) { alert('Pilih file audio terlebih dahulu!'); return; }

                setLoading(transcribeBtn, true);
                podcastOutputDiv.innerHTML = '<p class="placeholder-text">Langkah 1/3: Mengunggah file audio ke server...</p>';
                
                try {
                    // Step 1: Upload file
                    const uploadResponse = await fetch('https://api.assemblyai.com/v2/upload', {
                        method: 'POST',
                        headers: { 'authorization': apiKey, 'Content-Type': file.type },
                        body: file
                    });
                    const uploadData = await uploadResponse.json();
                    const uploadURL = uploadData.upload_url;
                    if (!uploadURL) throw new Error("Gagal mengunggah file.");

                    podcastOutputDiv.innerHTML = '<p class="placeholder-text">Langkah 2/3: Mengirim file untuk ditranskripsi...</p>';

                    // Step 2: Submit for transcription
                    const transcribeResponse = await fetch('https://api.assemblyai.com/v2/transcript', {
                        method: 'POST',
                        headers: { 'authorization': apiKey, 'Content-Type': 'application/json' },
                        body: JSON.stringify({ audio_url: uploadURL })
                    });
                    const transcribeData = await transcribeResponse.json();
                    const transcriptId = transcribeData.id;

                    podcastOutputDiv.innerHTML = `<p class="placeholder-text">Langkah 3/3: Memproses transkripsi (ID: ${transcriptId})... Mohon tunggu.</p>`;

                    // Step 3: Poll for result
                    while (true) {
                        await new Promise(resolve => setTimeout(resolve, 3000)); // Tunggu 3 detik
                        const pollResponse = await fetch(`https://api.assemblyai.com/v2/transcript/${transcriptId}`, {
                            headers: { 'authorization': apiKey }
                        });
                        const pollData = await pollResponse.json();
                        if (pollData.status === 'completed') {
                            podcastOutputDiv.textContent = pollData.text;
                            break;
                        } else if (pollData.status === 'failed') {
                            throw new Error(`Transkripsi gagal: ${pollData.error}`);
                        }
                    }
                } catch (error) {
                    alert(`Error: ${error.message}`);
                    podcastOutputDiv.innerHTML = '<p class="placeholder-text">Terjadi kesalahan. Cek API Key dan coba lagi.</p>';
                } finally {
                    setLoading(transcribeBtn, false);
                }
            });

            // === FUNGSI PEMANGGIL & BANTU ===
            async function callOpenAIChat(messages, max_tokens, buttonElement) {
                const apiKey = openAIKeyInput.value.trim();
                if (!apiKey) { alert('OpenAI API Key belum diisi!'); return null; }
                setLoading(buttonElement, true);
                try {
                    const response = await fetch('https://api.openai.com/v1/chat/completions', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${apiKey}` },
                        body: JSON.stringify({ model: "gpt-4o-mini", messages, max_tokens, temperature: 0.75 }),
                    });
                    if (!response.ok) { const err = await response.json(); throw new Error(err.error.message); }
                    const data = await response.json();
                    return data.choices[0].message.content;
                } catch (error) {
                    alert(`Error: ${error.message}`); return null;
                } finally {
                    setLoading(buttonElement, false);
                }
            }

            function setLoading(button, isLoading) {
                const spinner = button.querySelector('.spinner');
                const btnText = button.querySelector('.btn-text');
                if (isLoading) {
                    button.disabled = true; spinner.style.display = 'block'; if(btnText) btnText.style.opacity = '0.5';
                } else {
                    button.disabled = false; spinner.style.display = 'none'; if(btnText) btnText.style.opacity = '1';
                }
            }
        });

        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const textToCopy = element.innerText || element.textContent;
            if(textToCopy.includes("akan muncul di sini...")){ alert("Tidak ada teks untuk disalin!"); return; }
            navigator.clipboard.writeText(textToCopy).then(() => { alert('Teks berhasil disalin!'); }, () => { alert('Gagal menyalin.'); });
        }
    </script>
</body>
</html>